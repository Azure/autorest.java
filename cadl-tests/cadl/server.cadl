import "@cadl-lang/rest";
import "@azure-tools/cadl-dpg";

using Cadl.Http;

@service({
  title: "Server",
  version: "1.0.0",
})
@server(
  "https://{domain}.{tld}",
  "Httpbin endpoint",
  {
    @doc("second-level domain, use httpbin")
    domain?: string = "httpbin",

    @doc("top-level domain, use org")
    tld?: string = "org",
  }
)
namespace Cadl.Server {
  @Azure.DPG.client({
    name: "ServerClient",
    service: Cadl.Server,
  })
  @route("/status/{code}")
  interface ServerOp {
    status(@path code: int32): OkResponse | NoContentResponse;
  }
}

@service({
  title: "AnotherServer",
  version: "v1",
})
@server(
  "{Endpoint}/contoso/{ApiVersion}",
  "Service endpoint",
  {
    @doc("Service endpoint")
    Endpoint: string,

    @doc("Api Version")
    @path
    ApiVersion: APIVersions,
  }
)
namespace Cadl.AnotherServer {
  enum APIVersions {
    v1: "v1",
  }

  @Azure.DPG.client({
    name: "AnotherServerClient",
    service: Cadl.AnotherServer,
  })
  @route("/another-server")
  interface AnotherServerOp {
    get(@path code: int32): OkResponse | NoContentResponse;
  }
}
