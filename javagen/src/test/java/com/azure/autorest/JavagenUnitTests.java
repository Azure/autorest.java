/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License. See License.txt in the project root for license information.
 */

package com.azure.autorest;

import com.azure.autorest.extension.base.model.codemodel.CodeModel;
import com.azure.autorest.extension.base.plugin.JavaSettings;
import com.azure.autorest.mapper.Mappers;
import com.azure.autorest.model.clientmodel.Client;
import com.azure.autorest.model.javamodel.JavaPackage;
import org.junit.Test;

/**
 * unit test entry
 */
public class JavagenUnitTests {

    @Test
    public void generateTest(){
        MockUnitJavagen javagen = new MockUnitJavagen();
        // SOURCE SWAGGER URL: https://github.com/Azure/azure-rest-api-specs/blob/main/specification/containerregistry/data-plane/Azure.ContainerRegistry/stable/2021-07-01/containerregistry.json
        // It's generated by preprocessor. It can be found under preprocessor module after calling autorest for generation.
        String fileName = "containerregistry-code-model-processed-no-tags.yaml";

        CodeModel codeModel = javagen.parseCodeModel(fileName);
        Client client = Mappers.getClientMapper().map(codeModel);
        JavaPackage javaPackage = javagen.writeToTemplates(JavaSettings.getInstance(), codeModel, client);

        System.out.println(javaPackage.getJavaFiles().size());
    }

}
